# Cargo 构建配置文件
# 用于交叉编译和平台特定设置

[build]
# 默认构建目标（如果不指定 --target）
# target = "x86_64-pc-windows-gnu"

# 并行编译线程数（留空 = 自动，或设置具体数字如 4）
# jobs = 4

# 构建脚本的执行环境设置
# rustflags = ["-C", "link-arg=-fuse-ld=lld"]

# ============================================================
# Windows x86_64 (MinGW)
# ============================================================
[target.x86_64-pc-windows-gnu]
linker = "x86_64-w64-mingw32-gcc"
ar = "x86_64-w64-mingw32-ar"
rustflags = [
    "-C", "link-arg=-static-libgcc",
    "-C", "opt-level=3",
]

# ============================================================
# Windows ARM64 (MinGW)
# ============================================================
[target.aarch64-pc-windows-gnu]
linker = "aarch64-w64-mingw32-gcc"
ar = "aarch64-w64-mingw32-ar"
rustflags = [
    "-C", "link-arg=-static-libgcc",
    "-C", "opt-level=3",
]

# ============================================================
# Linux x86_64
# ============================================================
[target.x86_64-unknown-linux-gnu]
linker = "x86_64-linux-gnu-gcc"
ar = "x86_64-linux-gnu-ar"

# ============================================================
# Linux ARM64
# ============================================================
[target.aarch64-unknown-linux-gnu]
linker = "aarch64-linux-gnu-gcc"
ar = "aarch64-linux-gnu-ar"

# ============================================================
# macOS x86_64
# ============================================================
[target.x86_64-apple-darwin]
linker = "clang"

# ============================================================
# macOS ARM64 (Apple Silicon)
# ============================================================
[target.aarch64-apple-darwin]
linker = "clang"

# ============================================================
# 环境变量设置
# ============================================================
[env]
# Windows 编译环境
CC_x86_64_pc_windows_gnu = "x86_64-w64-mingw32-gcc"
CXX_x86_64_pc_windows_gnu = "x86_64-w64-mingw32-g++"
AR_x86_64_pc_windows_gnu = "x86_64-w64-mingw32-ar"

CC_aarch64_pc_windows_gnu = "aarch64-w64-mingw32-gcc"
CXX_aarch64_pc_windows_gnu = "aarch64-w64-mingw32-g++"
AR_aarch64_pc_windows_gnu = "aarch64-w64-mingw32-ar"

# Linux 编译环境
CC_x86_64_unknown_linux_gnu = "x86_64-linux-gnu-gcc"
CXX_x86_64_unknown_linux_gnu = "x86_64-linux-gnu-g++"
AR_x86_64_unknown_linux_gnu = "x86_64-linux-gnu-ar"

CC_aarch64_unknown_linux_gnu = "aarch64-linux-gnu-gcc"
CXX_aarch64_unknown_linux_gnu = "aarch64-linux-gnu-g++"
AR_aarch64_unknown_linux_gnu = "aarch64-linux-gnu-ar"

# ============================================================
# Profile 配置
# ============================================================

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
strip = true
panic = "abort"

[profile.release-with-debug]
inherits = "release"
debug = true
strip = false
